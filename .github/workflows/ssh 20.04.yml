name: Ubuntu 20.04 SSH
run-name: ChÃ o má»«ng ${{ github.actor }} Ä‘áº¿n vá»›i Rinne VPS ðŸš€
on:
  workflow_dispatch:
    inputs:
      ps5:
        description: 'ThÃªm tÃªn ngÆ°á»i dÃ¹ng'
        required: false
      ps:
        description: 'Máº­t kháº©u ngÆ°á»i dÃ¹ng'
        required: true
      os:
        description: 'SSH KEY PUBLIC Cá»¦A Báº N'
        required: true
      
jobs:
  Ubuntu_2004:
    timeout-minutes: 360
    runs-on: ubuntu-20.04
    steps:
    
    
    - name: Äang cháº¡y...
      run: |
           sudo su runneradmin
           cd
           sudo service sshd start
           
           
           sudo useradd -m runneradmin &>/dev/null &
           sudo useradd -m ${{ github.event.inputs.ps5 }} &>/dev/null &
           echo 'runneradmin:${{ github.event.inputs.ps }}' | sudo chpasswd &>/dev/null &
           sudo sed -i 's/\/bin\/sh/\/bin\/bash/g' /etc/passwd &>/dev/null &
           sudo useradd -m runner &>/dev/null &
           echo 'runner:${{ github.event.inputs.ps }}' | sudo chpasswd &>/dev/null &
           echo '${{ github.event.inputs.ps5 }}:${{ github.event.inputs.ps }}' | sudo chpasswd &>/dev/null &
           sudo sed -i 's/\/bin\/sh/\/bin\/bash/g' /etc/passwd &>/dev/null &
           echo TÃªn ngÆ°á»i dÃ¹ng lÃ : ${{ github.event.inputs.ps5 }} , runneradmin, runner
           cd && cd && cd && cd && echo "${{ github.event.inputs.os }}"  >> /home/runneradmin/.ssh/authorized_keys
           sudo apt update &>/dev/null 
           sudo apt install snapd -y &>/dev/null 
           sudo snap install ngrok &>/dev/null 
           echo TOKEN NGROK ÄÆ¯á»¢C Táº O Bá»žI MÃŒNH, Báº N Sáº¼ KHÃ”NG Cáº¦N NHáº¬P TOKEN
           ngrok authtoken 2Q2rHTw4NtzRr7TmzWjgDtasgoF_5hJEnRDGjGMj3bYC25JoS &>/dev/null &
           ngrok authtoken 2Q2rLzdiscxRmtlgRGVUiPyrjKK_53w6FYjWtS9KJGu9Gctfu &>/dev/null &
           ngrok tcp 22 &>/dev/null &
           echo Äá»ƒ káº¿t ná»‘i ssh qua trÃ¬nh vÃ o ssh, nháº­p IP sau, vÃ  bá» "tcp://" sá»‘ port lÃ  sá»‘ Ä‘áº±ng sau dáº¥u hai cháº¥m
           curl -s localhost:4040/api/tunnels | jq -r .tunnels[0].public_url || echo "Lá»—i token"
           echo Vá»›i OPENSSH CLI nháº­p ssh TÃŠN NGÆ¯á»œI DÃ™NG@IP -p Sá» PORTS
           yes &>/dev/null
        
