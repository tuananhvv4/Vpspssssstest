name: Windows Server 2022 Chrome Remote Desktop 
run-name: Ch√†o m·ª´ng ${{ github.actor }} ƒë·∫øn v·ªõi Rinne VPS üöÄ
on:
  workflow_dispatch:
    inputs:
      os:
        description: 'Nh·∫≠p m√£ Windows (Powershell) t·ª´ Chrome Remote Desktop'
        required: true
      os2:
        description: 'Nh·∫≠p m·∫≠t kh·∫©u cho ng∆∞·ªùi d√πng'
        required: true
      pin:
        description: 'Nh·∫≠p PIN cho Chrome Remote Desktop (6 s·ªë tr·ªü l√™n) '
        required: true
      os3:
        description: 'Nh·∫≠p m√£ token Ngrok (tu·ª≥ ch·ªçn)'
        required: false
jobs:
  Windows_Server_2022:
    timeout-minutes: 360
    runs-on: windows-latest
    name: ƒêang ch·∫°y
    steps:
    - name: T·∫£i code c·∫•u h√¨nh...
      uses: actions/checkout@v3
      timeout-minutes: 360
    - name: T·∫°o t√†i kho·∫£n
      run: |
            powershell.exe -File 1.ps1 > $null
            net.exe user $env:UserName ${{ github.event.inputs.os2 }} > $null
            net user installer ${{ github.event.inputs.os2 }} > $null
      timeout-minutes: 360
    - name: Ch·∫°y Chrome Remote Desktop & Ngrok
      run: |
            choco install ngrok > $null
            ngrok config add-authtoken ${{ github.event.inputs.os3 }} > $null
            powershell.exe -File c.ps1 > $null
            ${{ github.event.inputs.os }} --pin=${{ github.event.inputs.pin }} > $null
    - name: Ch·∫°y Ngrok (N·∫øu b·∫°n ƒë√£ nh·∫≠p token)
      shell: bash
      run: bash 3389.sh
      timeout-minutes: 360
    - name: Username & IP NGROK
      run: |
            write-host IP L√Ä:
            curl -s localhost:4040/api/tunnels | jq -r .tunnels[0].public_url || echo "L·ªói token"
            write-host Username: $env:UserName
            write-host Username: installer
            write-host Password: HI·ªÇN TH·ªä M·∫¨T KH·∫®U ƒê√É B·ªä XO√Å V√å L√ç DO B·∫¢O M·∫¨T

         
    - name: Ch·∫°y th√†nh c√¥ng VPS, H√£y v√†o Chrome Remote Desktop ƒë·ªÉ truy c·∫≠p
      run: |
            powershell.exe -File 3.ps1
      timeout-minutes: 360
    - name: ƒê√£ xong! Ch√∫c b·∫°n vui v·∫ª
      run: |
            ping -t 127.0.0.1
            
      timeout-minutes: 360
